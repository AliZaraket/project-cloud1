@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<link rel="stylesheet" href="~/css/styles.css">
<div class="container mt-4">
    <h2>Weather Checker</h2>
    <input type="text" id="cityInput" class="form-control" placeholder="Enter city name" />
    <button class="btn btn-primary mt-2" onclick="getWeather()">Get Weather</button>

    <div id="weatherResult" class="mt-3"></div>
</div>

<script>
    async function getWeather() {
        const city = document.getElementById('cityInput').value.trim();
        const weatherResultDiv = document.getElementById('weatherResult');
        weatherResultDiv.innerHTML = "Loading...";

        if (city === "") {
            weatherResultDiv.innerHTML = "Please enter a city name.";
            return;
        }

        try {
            // Make a request to the .NET API endpoint
            const response = await fetch(`/api/weather/${city}`);
            const data = await response.json();

            if (response.ok) {
                // Display weather information
                weatherResultDiv.innerHTML = `
                        <h4>Weather in ${city}</h4>
                        <p>${data.message}</p>
                    `;
            } else {
                // Display error message
                weatherResultDiv.innerHTML = data.error || 'Error fetching weather data';
            }
        } catch (error) {
            weatherResultDiv.innerHTML = 'Error: Unable to fetch weather data';
        }
    }
</script>
